---
layout: post
title: CMake 学习笔记
data: 2017-11-6 21:38:00
categories: CMake
tags: tools script
---

* content
{:toc}

本文记录了CMake的一些基本的用法和示例, 方便查阅和使用. 

```cmake
CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
PROJECT(solutionName)
FIND_PACKAGE(VTK)
INCLUDE(${VTK_USE_FILE})
ADD_EXECUTABLE(projectName main.cpp)
TARGET_LINK_LIBRARIES(projectName ${VTK_LIBRARIES})
```




## Take Care

* CMake 的命令名不区分大小写


## CMakeLists.txt

### CMAKE\_MINIMUM\_REQUIRED

**格式:** CMAKE\_MINIMUM\_REQUIRED(VERSION major[.minor[.patch[.tweak]]] [FATAL_ERROR])

第一个参数 `VERSION` 是关键字, 要大写; 第二个参数为指定的版本号; 第三个参数为可选参数. 如果构建工程使用的 CMake 版本没有达到要求, 配置会被终止, 且显示错误信息. 


### PROJECT

**格式:** PROJECT(projectName [CXX] [C] [Java])

该命令指定了解决方案的名称; 可以指定解决方案支持的语言, 语言为可选参数. 默认支持 C/C++. 该命令执行后会产生两个新的变量: `<projectName>_BINARY_DIR` 和 `<projectName>_SOURCE_DIR`. 另外 CMake 预定义了两个变量 `PROJECT_BINARY_DIR` 和 `PROJECT_SOURCE_DIR`, 值和前面两个一致. 另外还有一个自动生成的变量 `PROJECT_NAME` 表示解决方案名称, 可以通过 `${PROJECT_NAME}` 来引用. 

**注意VS中"解决方案"和"项目"的区别.**


### FIND PACKAGE

**格式:** FIND\_PACKAGE(<package> [version] [EXACT] [QUIET] [[REQUIRED|COMPONENTS] [components...]] [NO\_POLICY\_SCOPE])

在使用 CMake 构建工程时, 往往会使用外部链接库, 便使用 `FIND PACKAGE` 命令. 我们通过例子来说明.

现在我们想在 CMakeLists 中加入 VTK(Visual ToolKit) 库, 分以下几步:

1. 找到 VTK 库中包含文件 `VTKConfig.cmake` 的路径: `F:\Program Files (x86)\VTK\lib\cmake\vtk-8.0`
2. 然后把该路径加入到用户的环境变量中. 我们令变量名为 `VTK_DIR`, 变量值为 `F:\Program Files (x86)\VTK\lib\cmake\vtk-8.0`.
3. 在 CMakeLists 中使用命令 `FIND PACKAGE(VTK)` 即可.

**注意:** 第2步中的环境变量名必须为 `xyz_DIR` 的格式, 而第3步要查找的模块名称必须是 `xyz`, 即必须和环境变量中的对应.  



### INCLUDE


### ADD_EXECUTABLE


### TARGET\_LINK\_LIBRARIES

